<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Trezanik MemMgr (C): tracked_memory.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Trezanik MemMgr (C)
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">C Memory Manager</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tracked_memory.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Memory Allocation tracking for the application.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;sys/queue.h&gt;</code><br/>
<code>#include &lt;pthread.h&gt;</code><br/>
<code>#include &lt;inttypes.h&gt;</code><br/>
<code>#include &lt;stdbool.h&gt;</code><br/>
</div>
<p><a href="tracked__memory_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmemblock__footer.html">memblock_footer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmemblock__header.html">memblock_header</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmem__context.html">mem_context</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a57045b12fc465df47e223a6aa98f95f3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a57045b12fc465df47e223a6aa98f95f3">USING_MEMORY_DEBUGGING</a></td></tr>
<tr class="separator:a57045b12fc465df47e223a6aa98f95f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab332d550e31ec677168b046e54f5d775"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#ab332d550e31ec677168b046e54f5d775">DISABLE_MEMORY_CHECK_TO_STDOUT</a></td></tr>
<tr class="separator:ab332d550e31ec677168b046e54f5d775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa80cc71650d16e47bb40fa850083efc0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#aa80cc71650d16e47bb40fa850083efc0">DISABLE_MEMORY_OP_TO_STDOUT</a></td></tr>
<tr class="separator:aa80cc71650d16e47bb40fa850083efc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacbb9e1f38be71e22df1584a37c56693"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#aacbb9e1f38be71e22df1584a37c56693">__STDC_FORMAT_MACROS</a></td></tr>
<tr class="separator:aacbb9e1f38be71e22df1584a37c56693"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f16e38be32a4bbda23c530b11e19fb8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a4f16e38be32a4bbda23c530b11e19fb8">MEM_LEAK_LOG_NAME</a>&#160;&#160;&#160;&quot;memdynamic.log&quot;</td></tr>
<tr class="separator:a4f16e38be32a4bbda23c530b11e19fb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac811ed79333c5131bf74f609b0b67fcf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#ac811ed79333c5131bf74f609b0b67fcf">MEM_MAX_FILENAME_LENGTH</a>&#160;&#160;&#160;31</td></tr>
<tr class="separator:ac811ed79333c5131bf74f609b0b67fcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af15f994b428f827c19ae31d1df47d7ca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#af15f994b428f827c19ae31d1df47d7ca">MEM_MAX_FUNCTION_LENGTH</a>&#160;&#160;&#160;31</td></tr>
<tr class="separator:af15f994b428f827c19ae31d1df47d7ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aa19886dfd5381ab173d9fcfec3e01d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a8aa19886dfd5381ab173d9fcfec3e01d">PRINT_POINTER</a>&#160;&#160;&#160;&quot;%08&quot; PRIxPTR</td></tr>
<tr class="separator:a8aa19886dfd5381ab173d9fcfec3e01d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3078f3c259e2a871314e3e0194896357"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a3078f3c259e2a871314e3e0194896357">MALLOC</a>(size)&#160;&#160;&#160;<a class="el" href="tracked__memory_8h.html#a060364772083abaaf94eee077a5d3365">tracked_alloc</a>(&amp;<a class="el" href="tracked__memory_8h.html#a7d7857f56a1eceeb304e53870738e18f">g_mem_ctx</a>, size, __FILE__, __FUNCTION__, __LINE__)</td></tr>
<tr class="separator:a3078f3c259e2a871314e3e0194896357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a718b6446905826d711cb7ef00808bb4e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a718b6446905826d711cb7ef00808bb4e">REALLOC</a>(ptr, size)&#160;&#160;&#160;<a class="el" href="tracked__memory_8h.html#a4e46491d14d0a28b73e4758cc2b20d3b">tracked_realloc</a>(&amp;<a class="el" href="tracked__memory_8h.html#a7d7857f56a1eceeb304e53870738e18f">g_mem_ctx</a>, ptr, size, __FILE__, __FUNCTION__, __LINE__)</td></tr>
<tr class="separator:a718b6446905826d711cb7ef00808bb4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89e21687efe425e8f99a4d0aac6f537c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a89e21687efe425e8f99a4d0aac6f537c">FREE</a>(varname)&#160;&#160;&#160;<a class="el" href="tracked__memory_8h.html#adaadfc4aa30023606455c7f940868825">tracked_free</a>(&amp;<a class="el" href="tracked__memory_8h.html#a7d7857f56a1eceeb304e53870738e18f">g_mem_ctx</a>, varname)</td></tr>
<tr class="separator:a89e21687efe425e8f99a4d0aac6f537c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa041ffb2d12d9cd00022df58acb31c92"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#aa041ffb2d12d9cd00022df58acb31c92">MEM_OUTPUT_LIMIT</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:aa041ffb2d12d9cd00022df58acb31c92"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:adc7040deea27628dba424c534b71dbbf"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbf">E_MEMORY_ERROR</a> { <br/>
&#160;&#160;<a class="el" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee">EC_NoError</a> = 0, 
<a class="el" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff">EC_NoMemoryBlock</a>, 
<a class="el" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45">EC_CorruptHeader</a>, 
<a class="el" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfac73a2ab817ee9057c110c277e1580317">EC_CorruptFooter</a>, 
<br/>
&#160;&#160;<a class="el" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfad493ed6f6910767ac848c9ebcc55c518">EC_SizeMismatch</a>
<br/>
 }</td></tr>
<tr class="separator:adc7040deea27628dba424c534b71dbbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab753a667917e4aa67a8e5ee2117083ba"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbf">E_MEMORY_ERROR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#ab753a667917e4aa67a8e5ee2117083ba">check_block</a> (struct <a class="el" href="structmemblock__header.html">memblock_header</a> *memory_block)</td></tr>
<tr class="separator:ab753a667917e4aa67a8e5ee2117083ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18ea1d9235496d3eeefa9e5ef683a7a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a18ea1d9235496d3eeefa9e5ef683a7a1">mem_context_destroy</a> (struct <a class="el" href="structmem__context.html">mem_context</a> *const context)</td></tr>
<tr class="separator:a18ea1d9235496d3eeefa9e5ef683a7a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a67a6685295c0e8f0d891fe56353b4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a0a67a6685295c0e8f0d891fe56353b4d">mem_context_init</a> (struct <a class="el" href="structmem__context.html">mem_context</a> *const context)</td></tr>
<tr class="separator:a0a67a6685295c0e8f0d891fe56353b4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed5a096e4418b4468d1f6eb94fe953a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a1ed5a096e4418b4468d1f6eb94fe953a">output_memory_info</a> (struct <a class="el" href="structmem__context.html">mem_context</a> *const context)</td></tr>
<tr class="separator:a1ed5a096e4418b4468d1f6eb94fe953a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a060364772083abaaf94eee077a5d3365"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a060364772083abaaf94eee077a5d3365">tracked_alloc</a> (struct <a class="el" href="structmem__context.html">mem_context</a> *const context, const uint32_t num_bytes, const char *file, const char *function, const uint32_t line)</td></tr>
<tr class="separator:a060364772083abaaf94eee077a5d3365"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaadfc4aa30023606455c7f940868825"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#adaadfc4aa30023606455c7f940868825">tracked_free</a> (struct <a class="el" href="structmem__context.html">mem_context</a> *const context, void *memory)</td></tr>
<tr class="separator:adaadfc4aa30023606455c7f940868825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e46491d14d0a28b73e4758cc2b20d3b"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a4e46491d14d0a28b73e4758cc2b20d3b">tracked_realloc</a> (struct <a class="el" href="structmem__context.html">mem_context</a> *const context, void *memory, const uint32_t new_num_bytes, const char *file, const char *function, const uint32_t line)</td></tr>
<tr class="separator:a4e46491d14d0a28b73e4758cc2b20d3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f0ff25556f5435b8c7048f58b3c80a9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a1f0ff25556f5435b8c7048f58b3c80a9">validate_memory</a> (struct <a class="el" href="structmem__context.html">mem_context</a> *const context, void *memory)</td></tr>
<tr class="separator:a1f0ff25556f5435b8c7048f58b3c80a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7d7857f56a1eceeb304e53870738e18f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structmem__context.html">mem_context</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tracked__memory_8h.html#a7d7857f56a1eceeb304e53870738e18f">g_mem_ctx</a></td></tr>
<tr class="separator:a7d7857f56a1eceeb304e53870738e18f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Memory Allocation tracking for the application. </p>
<dl class="section author"><dt>Author</dt><dd>James Warren </dd></dl>

<p>Definition in file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="aacbb9e1f38be71e22df1584a37c56693"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __STDC_FORMAT_MACROS</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00030">30</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab332d550e31ec677168b046e54f5d775"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DISABLE_MEMORY_CHECK_TO_STDOUT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00015">15</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa80cc71650d16e47bb40fa850083efc0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DISABLE_MEMORY_OP_TO_STDOUT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00016">16</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

</div>
</div>
<a class="anchor" id="a89e21687efe425e8f99a4d0aac6f537c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FREE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">varname</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="tracked__memory_8h.html#adaadfc4aa30023606455c7f940868825">tracked_free</a>(&amp;<a class="el" href="tracked__memory_8h.html#a7d7857f56a1eceeb304e53870738e18f">g_mem_ctx</a>, varname)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro to delete tracked memory </p>

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00351">351</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

<p>Referenced by <a class="el" href="main_8c_source.html#l00012">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a3078f3c259e2a871314e3e0194896357"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MALLOC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">size</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="tracked__memory_8h.html#a060364772083abaaf94eee077a5d3365">tracked_alloc</a>(&amp;<a class="el" href="tracked__memory_8h.html#a7d7857f56a1eceeb304e53870738e18f">g_mem_ctx</a>, size, __FILE__, __FUNCTION__, __LINE__)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro to create tracked memory </p>

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00345">345</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

<p>Referenced by <a class="el" href="main_8c_source.html#l00012">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a4f16e38be32a4bbda23c530b11e19fb8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_LEAK_LOG_NAME&#160;&#160;&#160;&quot;memdynamic.log&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00036">36</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

<p>Referenced by <a class="el" href="tracked__memory_8c_source.html#l00074">mem_context_destroy()</a>, and <a class="el" href="tracked__memory_8c_source.html#l00182">output_memory_info()</a>.</p>

</div>
</div>
<a class="anchor" id="ac811ed79333c5131bf74f609b0b67fcf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_MAX_FILENAME_LENGTH&#160;&#160;&#160;31</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00037">37</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

</div>
</div>
<a class="anchor" id="af15f994b428f827c19ae31d1df47d7ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_MAX_FUNCTION_LENGTH&#160;&#160;&#160;31</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00038">38</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa041ffb2d12d9cd00022df58acb31c92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_OUTPUT_LIMIT&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The amount of bytes (limit) printed to output under the Data field </p>

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00354">354</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

<p>Referenced by <a class="el" href="tracked__memory_8c_source.html#l00182">output_memory_info()</a>.</p>

</div>
</div>
<a class="anchor" id="a8aa19886dfd5381ab173d9fcfec3e01d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_POINTER&#160;&#160;&#160;&quot;%08&quot; PRIxPTR</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00050">50</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

<p>Referenced by <a class="el" href="tracked__memory_8c_source.html#l00182">output_memory_info()</a>.</p>

</div>
</div>
<a class="anchor" id="a718b6446905826d711cb7ef00808bb4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REALLOC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">size&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="tracked__memory_8h.html#a4e46491d14d0a28b73e4758cc2b20d3b">tracked_realloc</a>(&amp;<a class="el" href="tracked__memory_8h.html#a7d7857f56a1eceeb304e53870738e18f">g_mem_ctx</a>, ptr, size, __FILE__, __FUNCTION__, __LINE__)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro to reallocate tracked memory </p>

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00348">348</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

</div>
</div>
<a class="anchor" id="a57045b12fc465df47e223a6aa98f95f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USING_MEMORY_DEBUGGING</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00014">14</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="adc7040deea27628dba424c534b71dbbf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbf">E_MEMORY_ERROR</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Memory-specific error codes. Used only as the return value from <a class="el" href="tracked__memory_8h.html#ab753a667917e4aa67a8e5ee2117083ba">check_block()</a>. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee"></a>EC_NoError</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff"></a>EC_NoMemoryBlock</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45"></a>EC_CorruptHeader</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adc7040deea27628dba424c534b71dbbfac73a2ab817ee9057c110c277e1580317"></a>EC_CorruptFooter</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adc7040deea27628dba424c534b71dbbfad493ed6f6910767ac848c9ebcc55c518"></a>EC_SizeMismatch</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="tracked__memory_8h_source.html#l00114">114</a> of file <a class="el" href="tracked__memory_8h_source.html">tracked_memory.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee">EC_NoError</a> = 0,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff">EC_NoMemoryBlock</a>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45">EC_CorruptHeader</a>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfac73a2ab817ee9057c110c277e1580317">EC_CorruptFooter</a>,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfad493ed6f6910767ac848c9ebcc55c518">EC_SizeMismatch</a></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;};</div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfad493ed6f6910767ac848c9ebcc55c518"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfad493ed6f6910767ac848c9ebcc55c518">EC_SizeMismatch</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00120">tracked_memory.h:120</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee">EC_NoError</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00116">tracked_memory.h:116</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45">EC_CorruptHeader</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00118">tracked_memory.h:118</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff">EC_NoMemoryBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00117">tracked_memory.h:117</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfac73a2ab817ee9057c110c277e1580317"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfac73a2ab817ee9057c110c277e1580317">EC_CorruptFooter</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00119">tracked_memory.h:119</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab753a667917e4aa67a8e5ee2117083ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbf">E_MEMORY_ERROR</a> check_block </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmemblock__header.html">memblock_header</a> *&#160;</td>
          <td class="paramname"><em>memory_block</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checks a block of memory, ensuring both the header and footer are not corrupt, and the rest of the block matches the original requestors specifications.</p>
<p>Define DISABLE_MEMORY_CHECK_TO_STDOUT to prevent stage-by-stage output of the checking process.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">memory_block</td><td>The block of memory to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">E_MEMORY_ERROR</td><td>The relevant memory error code as to the block status; should hopefully always be EC_NoError </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tracked__memory_8c_source.html#l00092">92</a> of file <a class="el" href="tracked__memory_8c_source.html">tracked_memory.c</a>.</p>

<p>References <a class="el" href="tracked__memory_8h_source.html#l00119">EC_CorruptFooter</a>, <a class="el" href="tracked__memory_8h_source.html#l00118">EC_CorruptHeader</a>, <a class="el" href="tracked__memory_8h_source.html#l00116">EC_NoError</a>, <a class="el" href="tracked__memory_8h_source.html#l00117">EC_NoMemoryBlock</a>, <a class="el" href="tracked__memory_8h_source.html#l00120">EC_SizeMismatch</a>, <a class="el" href="tracked__memory_8h_source.html#l00092">memblock_header::file</a>, <a class="el" href="tracked__memory_8h_source.html#l00086">memblock_header::footer</a>, <a class="el" href="tracked__memory_8h_source.html#l00098">memblock_header::line</a>, <a class="el" href="tracked__memory_8h_source.html#l00066">memblock_footer::magic</a>, <a class="el" href="tracked__memory_8h_source.html#l00083">memblock_header::magic</a>, <a class="el" href="tracked__memory_8c_source.html#l00047">mem_footer_magic</a>, <a class="el" href="tracked__memory_8c_source.html#l00046">mem_header_magic</a>, <a class="el" href="tracked__memory_8h_source.html#l00102">memblock_header::real_size</a>, and <a class="el" href="tracked__memory_8h_source.html#l00100">memblock_header::requested_size</a>.</p>

<p>Referenced by <a class="el" href="tracked__memory_8c_source.html#l00182">output_memory_info()</a>, and <a class="el" href="tracked__memory_8c_source.html#l00527">validate_memory()</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        uint32_t        block_size = 0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">if</span> ( memory_block == NULL )</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="keywordflow">goto</span> null_block;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#if !defined(DISABLE_MEMORY_CHECK_TO_STDOUT)</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;\tChecking Memory Block %p..\n&quot;</span>,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                memory_block);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        printf(<span class="stringliteral">&quot;\t\tGlobal Header magic number is %lu bytes in size :: %#x\n&quot;</span>,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <span class="keyword">sizeof</span>(<a class="code" href="tracked__memory_8c.html#ac870dbfc709df78d9ee713843f55e894">mem_header_magic</a>), <a class="code" href="tracked__memory_8c.html#ac870dbfc709df78d9ee713843f55e894">mem_header_magic</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        printf(<span class="stringliteral">&quot;\t\tGlobal Footer magic number is %lu bytes in size :: %#x\n&quot;</span>,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                <span class="keyword">sizeof</span>(<a class="code" href="tracked__memory_8c.html#a89ab5016ef388d7a5691e4d77208cc32">mem_footer_magic</a>), <a class="code" href="tracked__memory_8c.html#a89ab5016ef388d7a5691e4d77208cc32">mem_footer_magic</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">if</span> ( memcmp(&amp;memory_block-&gt;<a class="code" href="structmemblock__header.html#a10ebc950edccb690a784aceb6362d696">magic</a>,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                &amp;<a class="code" href="tracked__memory_8c.html#ac870dbfc709df78d9ee713843f55e894">mem_header_magic</a>,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <span class="keyword">sizeof</span>(<a class="code" href="tracked__memory_8c.html#ac870dbfc709df78d9ee713843f55e894">mem_header_magic</a>)) != 0 )</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <span class="comment">/* memory_block magic number has been modified; block contents</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">                 * are unstable */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <span class="keywordflow">goto</span> corrupt_header;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#if !defined(DISABLE_MEMORY_CHECK_TO_STDOUT)</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;\t\tHas a valid header (%lu bytes, %#x)...\n&quot;</span>,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                <span class="keyword">sizeof</span>(memory_block-&gt;<a class="code" href="structmemblock__header.html#a10ebc950edccb690a784aceb6362d696">magic</a>), memory_block-&gt;<a class="code" href="structmemblock__header.html#a10ebc950edccb690a784aceb6362d696">magic</a>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        printf(<span class="stringliteral">&quot;\t\tHeader Info:: %u (%u requested) bytes, line %u in %s\n&quot;</span>,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                memory_block-&gt;<a class="code" href="structmemblock__header.html#acbea4f5572643309ac41e9493baaa7f7">real_size</a>, memory_block-&gt;<a class="code" href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">requested_size</a>,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                memory_block-&gt;<a class="code" href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">line</a>, memory_block-&gt;<a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> ( memory_block-&gt;<a class="code" href="structmemblock__header.html#a21ce1e9005809a1f4ac9d9fc16f0ccc6">footer</a> == NULL ||</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                memcmp(&amp;memory_block-&gt;<a class="code" href="structmemblock__header.html#a21ce1e9005809a1f4ac9d9fc16f0ccc6">footer</a>-&gt;<a class="code" href="structmemblock__footer.html#adbe248bf9ad8f03cdc7c202140989da9">magic</a>, &amp;<a class="code" href="tracked__memory_8c.html#a89ab5016ef388d7a5691e4d77208cc32">mem_footer_magic</a>, <span class="keyword">sizeof</span>(<a class="code" href="tracked__memory_8c.html#a89ab5016ef388d7a5691e4d77208cc32">mem_footer_magic</a>)) != 0 )</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                <span class="comment">/* memory_block footer magic has been modified - as the header</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">                 * is not corrupt, we can retrieve the allocation info safely */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="keywordflow">goto</span> corrupt_footer;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#if !defined(DISABLE_MEMORY_CHECK_TO_STDOUT)</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;\t\tHas a valid footer (%lu bytes, %#x)...\n&quot;</span>,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="keyword">sizeof</span>(memory_block-&gt;<a class="code" href="structmemblock__header.html#a21ce1e9005809a1f4ac9d9fc16f0ccc6">footer</a>-&gt;<a class="code" href="structmemblock__footer.html#adbe248bf9ad8f03cdc7c202140989da9">magic</a>),</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                memory_block-&gt;<a class="code" href="structmemblock__header.html#a21ce1e9005809a1f4ac9d9fc16f0ccc6">footer</a>-&gt;<a class="code" href="structmemblock__footer.html#adbe248bf9ad8f03cdc7c202140989da9">magic</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">// calculate the size requested by removing the header + footer</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        block_size = ((uint8_t*)memory_block-&gt;<a class="code" href="structmemblock__header.html#a21ce1e9005809a1f4ac9d9fc16f0ccc6">footer</a>) - ((uint8_t*)memory_block + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structmemblock__header.html">memblock_header</a>));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#if !defined(DISABLE_MEMORY_CHECK_TO_STDOUT)</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;\t\tCalculated block_size is %u bytes\n&quot;</span>, block_size);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> ( memory_block-&gt;<a class="code" href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">requested_size</a> != block_size )</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="comment">/* The size stored by the memory_block header is different from</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">                 * that calculated (remember we&#39;ve already validated the magic</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">                 * numbers) */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="keywordflow">goto</span> invalid_size;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#if !defined(DISABLE_MEMORY_CHECK_TO_STDOUT)</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;\t\tHas a valid app_mem size (%u bytes)\n\t\tValidated!\n&quot;</span>,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;               block_size);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment">// memory_block is as expected</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee">EC_NoError</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;null_block:</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// Optional: Raise error</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff">EC_NoMemoryBlock</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;corrupt_header:</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">// Optional: Raise error</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45">EC_CorruptHeader</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;corrupt_footer:</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">// Optional: Raise error</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfac73a2ab817ee9057c110c277e1580317">EC_CorruptFooter</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;invalid_size:</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">// Optional: Raise error</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfad493ed6f6910767ac848c9ebcc55c518">EC_SizeMismatch</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfad493ed6f6910767ac848c9ebcc55c518"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfad493ed6f6910767ac848c9ebcc55c518">EC_SizeMismatch</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00120">tracked_memory.h:120</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee">EC_NoError</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00116">tracked_memory.h:116</a></div></div>
<div class="ttc" id="structmemblock__header_html_a97093dcb31daa58a36e471701b63d0d3"><div class="ttname"><a href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">memblock_header::file</a></div><div class="ttdeci">char file[MEM_MAX_FILENAME_LENGTH+1]</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00092">tracked_memory.h:92</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_a89ab5016ef388d7a5691e4d77208cc32"><div class="ttname"><a href="tracked__memory_8c.html#a89ab5016ef388d7a5691e4d77208cc32">mem_footer_magic</a></div><div class="ttdeci">const unsigned mem_footer_magic</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00047">tracked_memory.c:47</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45">EC_CorruptHeader</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00118">tracked_memory.h:118</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_ac870dbfc709df78d9ee713843f55e894"><div class="ttname"><a href="tracked__memory_8c.html#ac870dbfc709df78d9ee713843f55e894">mem_header_magic</a></div><div class="ttdeci">const unsigned mem_header_magic</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00046">tracked_memory.c:46</a></div></div>
<div class="ttc" id="structmemblock__header_html_aa2bb67f4837cf735956c591e23e4c800"><div class="ttname"><a href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">memblock_header::line</a></div><div class="ttdeci">uint32_t line</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00098">tracked_memory.h:98</a></div></div>
<div class="ttc" id="structmemblock__header_html_a9f32a9108b8ca49a6296605b42ee3a54"><div class="ttname"><a href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">memblock_header::requested_size</a></div><div class="ttdeci">uint32_t requested_size</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00100">tracked_memory.h:100</a></div></div>
<div class="ttc" id="structmemblock__header_html_a21ce1e9005809a1f4ac9d9fc16f0ccc6"><div class="ttname"><a href="structmemblock__header.html#a21ce1e9005809a1f4ac9d9fc16f0ccc6">memblock_header::footer</a></div><div class="ttdeci">struct memblock_footer * footer</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00086">tracked_memory.h:86</a></div></div>
<div class="ttc" id="structmemblock__header_html_acbea4f5572643309ac41e9493baaa7f7"><div class="ttname"><a href="structmemblock__header.html#acbea4f5572643309ac41e9493baaa7f7">memblock_header::real_size</a></div><div class="ttdeci">uint32_t real_size</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00102">tracked_memory.h:102</a></div></div>
<div class="ttc" id="structmemblock__footer_html_adbe248bf9ad8f03cdc7c202140989da9"><div class="ttname"><a href="structmemblock__footer.html#adbe248bf9ad8f03cdc7c202140989da9">memblock_footer::magic</a></div><div class="ttdeci">unsigned magic</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00066">tracked_memory.h:66</a></div></div>
<div class="ttc" id="structmemblock__header_html"><div class="ttname"><a href="structmemblock__header.html">memblock_header</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00076">tracked_memory.h:76</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff">EC_NoMemoryBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00117">tracked_memory.h:117</a></div></div>
<div class="ttc" id="structmemblock__header_html_a10ebc950edccb690a784aceb6362d696"><div class="ttname"><a href="structmemblock__header.html#a10ebc950edccb690a784aceb6362d696">memblock_header::magic</a></div><div class="ttdeci">unsigned magic</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00083">tracked_memory.h:83</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfac73a2ab817ee9057c110c277e1580317"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfac73a2ab817ee9057c110c277e1580317">EC_CorruptFooter</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00119">tracked_memory.h:119</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a18ea1d9235496d3eeefa9e5ef683a7a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mem_context_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmem__context.html">mem_context</a> *const&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroys a previously initialized memory context. If any memory blocks exist within the list, it is declared as a memory leak, and will call the <a class="el" href="tracked__memory_8h.html#a1ed5a096e4418b4468d1f6eb94fe953a">output_memory_info()</a> function to report it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>The memory context to destroy </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tracked__memory_8c_source.html#l00074">74</a> of file <a class="el" href="tracked__memory_8c_source.html">tracked_memory.c</a>.</p>

<p>References <a class="el" href="tracked__memory_8h_source.html#l00166">mem_context::lock</a>, <a class="el" href="tracked__memory_8h_source.html#l00036">MEM_LEAK_LOG_NAME</a>, <a class="el" href="tracked__memory_8c_source.html#l00182">output_memory_info()</a>, and <a class="el" href="queue_8h_source.html#l00553">TAILQ_EMPTY</a>.</p>

<p>Referenced by <a class="el" href="main_8c_source.html#l00012">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;{</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">if</span> ( !<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;context-&gt;memblocks) )</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                printf(<span class="stringliteral">&quot;Memory Leak Detected\n\nCheck &#39;%s&#39; for details\n&quot;</span>,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                       <a class="code" href="tracked__memory_8h.html#a4f16e38be32a4bbda23c530b11e19fb8">MEM_LEAK_LOG_NAME</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="tracked__memory_8c.html#a1ed5a096e4418b4468d1f6eb94fe953a">output_memory_info</a>(context);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        pthread_mutex_destroy(&amp;context-&gt;<a class="code" href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">lock</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
<div class="ttc" id="tracked__memory_8c_html_a1ed5a096e4418b4468d1f6eb94fe953a"><div class="ttname"><a href="tracked__memory_8c.html#a1ed5a096e4418b4468d1f6eb94fe953a">output_memory_info</a></div><div class="ttdeci">void output_memory_info(struct mem_context *const context)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00182">tracked_memory.c:182</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_a4f16e38be32a4bbda23c530b11e19fb8"><div class="ttname"><a href="tracked__memory_8h.html#a4f16e38be32a4bbda23c530b11e19fb8">MEM_LEAK_LOG_NAME</a></div><div class="ttdeci">#define MEM_LEAK_LOG_NAME</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00036">tracked_memory.h:36</a></div></div>
<div class="ttc" id="structmem__context_html_a0ab6d63011eb813840718d80623e16c9"><div class="ttname"><a href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">mem_context::lock</a></div><div class="ttdeci">pthread_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00166">tracked_memory.h:166</a></div></div>
<div class="ttc" id="queue_8h_html_ac3c9da7ac712eacbbad5cc54d7a3477e"><div class="ttname"><a href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a></div><div class="ttdeci">#define TAILQ_EMPTY(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00553">queue.h:553</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0a67a6685295c0e8f0d891fe56353b4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mem_context_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmem__context.html">mem_context</a> *const&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the memory context, ready for usage.</p>
<p>Must be destroyed via <a class="el" href="tracked__memory_8h.html#a18ea1d9235496d3eeefa9e5ef683a7a1">mem_context_destroy()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>The memory context to initialize </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tracked__memory_8c_source.html#l00055">55</a> of file <a class="el" href="tracked__memory_8c_source.html">tracked_memory.c</a>.</p>

<p>References <a class="el" href="tracked__memory_8h_source.html#l00158">mem_context::allocs</a>, <a class="el" href="tracked__memory_8h_source.html#l00160">mem_context::current_allocated</a>, <a class="el" href="tracked__memory_8h_source.html#l00159">mem_context::frees</a>, <a class="el" href="tracked__memory_8h_source.html#l00166">mem_context::lock</a>, <a class="el" href="tracked__memory_8h_source.html#l00167">mem_context::lock_attrib</a>, <a class="el" href="queue_8h_source.html#l00597">TAILQ_INIT</a>, and <a class="el" href="tracked__memory_8h_source.html#l00161">mem_context::total_allocated</a>.</p>

<p>Referenced by <a class="el" href="main_8c_source.html#l00012">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        pthread_mutexattr_settype(&amp;context-&gt;<a class="code" href="structmem__context.html#a270a8ee10aed0945ffbbfc1a806794c3">lock_attrib</a>, PTHREAD_MUTEX_RECURSIVE);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        pthread_mutexattr_settype(&amp;context-&gt;<a class="code" href="structmem__context.html#a270a8ee10aed0945ffbbfc1a806794c3">lock_attrib</a>, PTHREAD_PROCESS_PRIVATE);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        pthread_mutex_init(&amp;context-&gt;<a class="code" href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">lock</a>, &amp;context-&gt;<a class="code" href="structmem__context.html#a270a8ee10aed0945ffbbfc1a806794c3">lock_attrib</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        context-&gt;<a class="code" href="structmem__context.html#a3eb8087c0f859202f13e8877f1871530">allocs</a>                 = 0;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        context-&gt;<a class="code" href="structmem__context.html#a816e6dda100a2b8133c078194cd41f11">frees</a>                  = 0;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        context-&gt;<a class="code" href="structmem__context.html#a8edd1cdf2fb7f8e841eb7abacb839a18">current_allocated</a>      = 0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        context-&gt;<a class="code" href="structmem__context.html#a513b900aa111101d2491b1395912e7a1">total_allocated</a>        = 0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="queue_8h.html#a449d224023780e46253b83b61e0a50a9">TAILQ_INIT</a>(&amp;context-&gt;memblocks);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
<div class="ttc" id="structmem__context_html_a8edd1cdf2fb7f8e841eb7abacb839a18"><div class="ttname"><a href="structmem__context.html#a8edd1cdf2fb7f8e841eb7abacb839a18">mem_context::current_allocated</a></div><div class="ttdeci">uint32_t current_allocated</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00160">tracked_memory.h:160</a></div></div>
<div class="ttc" id="structmem__context_html_a816e6dda100a2b8133c078194cd41f11"><div class="ttname"><a href="structmem__context.html#a816e6dda100a2b8133c078194cd41f11">mem_context::frees</a></div><div class="ttdeci">uint32_t frees</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00159">tracked_memory.h:159</a></div></div>
<div class="ttc" id="structmem__context_html_a513b900aa111101d2491b1395912e7a1"><div class="ttname"><a href="structmem__context.html#a513b900aa111101d2491b1395912e7a1">mem_context::total_allocated</a></div><div class="ttdeci">uint32_t total_allocated</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00161">tracked_memory.h:161</a></div></div>
<div class="ttc" id="structmem__context_html_a270a8ee10aed0945ffbbfc1a806794c3"><div class="ttname"><a href="structmem__context.html#a270a8ee10aed0945ffbbfc1a806794c3">mem_context::lock_attrib</a></div><div class="ttdeci">pthread_mutexattr_t lock_attrib</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00167">tracked_memory.h:167</a></div></div>
<div class="ttc" id="structmem__context_html_a0ab6d63011eb813840718d80623e16c9"><div class="ttname"><a href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">mem_context::lock</a></div><div class="ttdeci">pthread_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00166">tracked_memory.h:166</a></div></div>
<div class="ttc" id="queue_8h_html_a449d224023780e46253b83b61e0a50a9"><div class="ttname"><a href="queue_8h.html#a449d224023780e46253b83b61e0a50a9">TAILQ_INIT</a></div><div class="ttdeci">#define TAILQ_INIT(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00597">queue.h:597</a></div></div>
<div class="ttc" id="structmem__context_html_a3eb8087c0f859202f13e8877f1871530"><div class="ttname"><a href="structmem__context.html#a3eb8087c0f859202f13e8877f1871530">mem_context::allocs</a></div><div class="ttdeci">uint32_t allocs</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00158">tracked_memory.h:158</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1ed5a096e4418b4468d1f6eb94fe953a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void output_memory_info </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmem__context.html">mem_context</a> *const&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called only in the destructor, but available for calling manually if desired; will always output the memory stats for the application run, but will also write out the information on any unfreed memory.</p>
<p>Outputs to MEM_LEAK_LOG_NAME, but if it's not writable, it is printed to stderr instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>The memory context to work with </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>causes warning 'cast to pointer from integer of different size' and 'format x expects argument of type unsigned int' </dd></dl>

<p>Definition at line <a class="el" href="tracked__memory_8c_source.html#l00182">182</a> of file <a class="el" href="tracked__memory_8c_source.html">tracked_memory.c</a>.</p>

<p>References <a class="el" href="tracked__memory_8h_source.html#l00158">mem_context::allocs</a>, <a class="el" href="tracked__memory_8c_source.html#l00037">block_offset_realmem</a>, <a class="el" href="tracked__memory_8c_source.html#l00092">check_block()</a>, <a class="el" href="tracked__memory_8h_source.html#l00160">mem_context::current_allocated</a>, <a class="el" href="tracked__memory_8h_source.html#l00119">EC_CorruptFooter</a>, <a class="el" href="tracked__memory_8h_source.html#l00118">EC_CorruptHeader</a>, <a class="el" href="tracked__memory_8h_source.html#l00116">EC_NoError</a>, <a class="el" href="tracked__memory_8h_source.html#l00117">EC_NoMemoryBlock</a>, <a class="el" href="tracked__memory_8h_source.html#l00120">EC_SizeMismatch</a>, <a class="el" href="tracked__memory_8h_source.html#l00159">mem_context::frees</a>, <a class="el" href="tracked__memory_8c_source.html#l00041">HEADER_FOOTER_SIZE</a>, <a class="el" href="tracked__memory_8h_source.html#l00036">MEM_LEAK_LOG_NAME</a>, <a class="el" href="tracked__memory_8h_source.html#l00354">MEM_OUTPUT_LIMIT</a>, <a class="el" href="tracked__memory_8h_source.html#l00050">PRINT_POINTER</a>, <a class="el" href="queue_8h_source.html#l00557">TAILQ_FOREACH</a>, <a class="el" href="queue_8h_source.html#l00659">TAILQ_REMOVE</a>, and <a class="el" href="tracked__memory_8h_source.html#l00161">mem_context::total_allocated</a>.</p>

<p>Referenced by <a class="el" href="tracked__memory_8c_source.html#l00074">mem_context_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;{</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keyword">enum</span> <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbf">E_MEMORY_ERROR</a>     result;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keyword">struct </span><a class="code" href="structmemblock__header.html">memblock_header</a>* block_ptr;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        FILE*           leak_file;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        int32_t         close_file = 1;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        uint32_t        i = 0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">// we don&#39;t store/track the user-requested amounts, only the real</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        uint32_t        requested_alloc;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        uint32_t        requested_unfreed;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment">/* since Windows has been kind enough to not provide more standards</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">         * complaint security functionality, we shall have to use their own</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">         * fopen_s. POSIX builds can happily use the &#39;x&#39; flag to provide a</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">         * decent security level - fopen_s is still vulnerable to potential</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">         * exploits ironically... */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#if defined(_WIN32)</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">if</span> ( fopen_s(&amp;leak_file, <a class="code" href="tracked__memory_8h.html#a4f16e38be32a4bbda23c530b11e19fb8">MEM_LEAK_LOG_NAME</a>, <span class="stringliteral">&quot;w+&quot;</span>) != 0 )</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">if</span> (( leak_file = fopen(<a class="code" href="tracked__memory_8h.html#a4f16e38be32a4bbda23c530b11e19fb8">MEM_LEAK_LOG_NAME</a>, <span class="stringliteral">&quot;w+&quot;</span>)) == NULL )</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor"></span>                leak_file = stdout;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                close_file = 0;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">/* Remove memory block sizes, multiplied by the number of allocations,</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">         * which is taken away from the total amount allocated. */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        requested_alloc         = context-&gt;<a class="code" href="structmem__context.html#a513b900aa111101d2491b1395912e7a1">total_allocated</a> - (<a class="code" href="tracked__memory_8c.html#a23fcee323662954abeea9a2b0d3d7bdf">HEADER_FOOTER_SIZE</a> * context-&gt;<a class="code" href="structmem__context.html#a3eb8087c0f859202f13e8877f1871530">allocs</a>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">/* Remove memory block sizes, multiplied by the number of pending frees,</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">         * which is to be taken away from the current amount still allocated. */</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        requested_unfreed       = context-&gt;<a class="code" href="structmem__context.html#a8edd1cdf2fb7f8e841eb7abacb839a18">current_allocated</a> - (<a class="code" href="tracked__memory_8c.html#a23fcee323662954abeea9a2b0d3d7bdf">HEADER_FOOTER_SIZE</a> * (context-&gt;<a class="code" href="structmem__context.html#a3eb8087c0f859202f13e8877f1871530">allocs</a> - context-&gt;<a class="code" href="structmem__context.html#a816e6dda100a2b8133c078194cd41f11">frees</a>));</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        fprintf(leak_file,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="stringliteral">&quot;# Details\n&quot;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="stringliteral">&quot;Header+Footer Size......: %lu\n&quot;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="stringliteral">&quot;# Code Stats\n&quot;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <span class="stringliteral">&quot;Allocations.............: %u\n&quot;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <span class="stringliteral">&quot;Frees...................: %u\n&quot;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <span class="stringliteral">&quot;Pending Frees...........: %u\n&quot;</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="stringliteral">&quot;# Totals, Real\n&quot;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="stringliteral">&quot;Bytes Allocated.........: %u\n&quot;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="stringliteral">&quot;Unfreed Bytes...........: %u\n&quot;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="stringliteral">&quot;# Totals, Requested\n&quot;</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="stringliteral">&quot;Bytes Allocated.........: %u\n&quot;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <span class="stringliteral">&quot;Unfreed Bytes...........: %u\n&quot;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="stringliteral">&quot;##################\n&quot;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="stringliteral">&quot;  Unfreed Blocks  \n&quot;</span>,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <a class="code" href="tracked__memory_8c.html#a23fcee323662954abeea9a2b0d3d7bdf">HEADER_FOOTER_SIZE</a>,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                context-&gt;<a class="code" href="structmem__context.html#a3eb8087c0f859202f13e8877f1871530">allocs</a>, context-&gt;<a class="code" href="structmem__context.html#a816e6dda100a2b8133c078194cd41f11">frees</a>, (context-&gt;<a class="code" href="structmem__context.html#a3eb8087c0f859202f13e8877f1871530">allocs</a> - context-&gt;<a class="code" href="structmem__context.html#a816e6dda100a2b8133c078194cd41f11">frees</a>),</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                context-&gt;<a class="code" href="structmem__context.html#a513b900aa111101d2491b1395912e7a1">total_allocated</a>, context-&gt;<a class="code" href="structmem__context.html#a8edd1cdf2fb7f8e841eb7abacb839a18">current_allocated</a>,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                requested_alloc, requested_unfreed</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                );</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a>(block_ptr, &amp;context-&gt;memblocks, np_blocks)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                i++;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                fprintf(leak_file,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                        <span class="stringliteral">&quot;##################\n&quot;</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                        <span class="stringliteral">&quot;%u)\n&quot;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                        <span class="stringliteral">&quot;Block...: &quot;</span> <a class="code" href="tracked__memory_8h.html#a8aa19886dfd5381ab173d9fcfec3e01d">PRINT_POINTER</a></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                        <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                        i, (uintptr_t)block_ptr</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                );</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                result = <a class="code" href="tracked__memory_8c.html#ab753a667917e4aa67a8e5ee2117083ba">check_block</a>(block_ptr);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keywordflow">switch</span> ( result )</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff">EC_NoMemoryBlock</a>:</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                        {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                fprintf(leak_file,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                        <span class="stringliteral">&quot;Error...: Block Pointer was NULL\n&quot;</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                );</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                        }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfac73a2ab817ee9057c110c277e1580317">EC_CorruptFooter</a>:</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                        {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                fprintf(leak_file,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                        <span class="stringliteral">&quot;Error...: Corrupt Footer\n&quot;</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                );</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                        }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45">EC_CorruptHeader</a>:</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                        {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                                fprintf(leak_file,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                        <span class="stringliteral">&quot;Error...: Corrupt Header\n&quot;</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                );</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                        }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfad493ed6f6910767ac848c9ebcc55c518">EC_SizeMismatch</a>:</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                        {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                fprintf(leak_file,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                        <span class="stringliteral">&quot;Error...: Size Mismatch (%u actual bytes)\n&quot;</span>,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                        block_ptr-&gt;<a class="code" href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">requested_size</a></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                );</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                        }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee">EC_NoError</a>:</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <span class="comment">/* can&#39;t fall through in switch, so have to do a secondary check</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">                 * as we can&#39;t print data that&#39;s corrupt or a NULL */</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                <span class="keywordflow">if</span> ( result != <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff">EC_NoMemoryBlock</a> &amp;&amp; result != <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45">EC_CorruptHeader</a> )</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                        fprintf(leak_file,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                <span class="stringliteral">&quot;Size....: %u\n&quot;</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                <span class="stringliteral">&quot;Function: %s\n&quot;</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                <span class="stringliteral">&quot;File....: %s\n&quot;</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                <span class="stringliteral">&quot;Line....: %u\n&quot;</span>,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                block_ptr-&gt;<a class="code" href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">requested_size</a>,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                block_ptr-&gt;<a class="code" href="structmemblock__header.html#ab3a09c5ab1300cb51e93ff910431c40f">function</a>,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                block_ptr-&gt;<a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                block_ptr-&gt;<a class="code" href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">line</a></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        );</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                        fprintf(leak_file, <span class="stringliteral">&quot;Data....: &quot;</span>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                        <span class="keywordflow">for</span> ( uint32_t j = 0;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                j &lt; block_ptr-&gt;<a class="code" href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">requested_size</a> &amp;&amp; j &lt; <a class="code" href="tracked__memory_8h.html#aa041ffb2d12d9cd00022df58acb31c92">MEM_OUTPUT_LIMIT</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                j++ )</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                        {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                fprintf(leak_file,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                        <span class="stringliteral">&quot;%02x &quot;</span>,</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                        <a class="code" href="tracked__memory_8c.html#ad4ec1862e1c0007f85c0d0eb6b75ff91">block_offset_realmem</a>(block_ptr)[j]);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                        fprintf(leak_file, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">if</span> ( close_file )</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                fclose(leak_file);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">/* try to free whatever we didn&#39;t during runtime; if any of these are</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">         * screwed (heap corruption) then this will probably trigger a crash */</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a>(block_ptr, &amp;context-&gt;memblocks, np_blocks)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <a class="code" href="queue_8h.html#aaae87ca18c28066e1a96221e762d1209">TAILQ_REMOVE</a>(&amp;context-&gt;memblocks, block_ptr, np_blocks);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                free(block_ptr);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfad493ed6f6910767ac848c9ebcc55c518"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfad493ed6f6910767ac848c9ebcc55c518">EC_SizeMismatch</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00120">tracked_memory.h:120</a></div></div>
<div class="ttc" id="structmem__context_html_a8edd1cdf2fb7f8e841eb7abacb839a18"><div class="ttname"><a href="structmem__context.html#a8edd1cdf2fb7f8e841eb7abacb839a18">mem_context::current_allocated</a></div><div class="ttdeci">uint32_t current_allocated</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00160">tracked_memory.h:160</a></div></div>
<div class="ttc" id="queue_8h_html_a16e5fc168e7f3494d4b1df54447d871e"><div class="ttname"><a href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a></div><div class="ttdeci">#define TAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00557">queue.h:557</a></div></div>
<div class="ttc" id="structmem__context_html_a816e6dda100a2b8133c078194cd41f11"><div class="ttname"><a href="structmem__context.html#a816e6dda100a2b8133c078194cd41f11">mem_context::frees</a></div><div class="ttdeci">uint32_t frees</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00159">tracked_memory.h:159</a></div></div>
<div class="ttc" id="structmem__context_html_a513b900aa111101d2491b1395912e7a1"><div class="ttname"><a href="structmem__context.html#a513b900aa111101d2491b1395912e7a1">mem_context::total_allocated</a></div><div class="ttdeci">uint32_t total_allocated</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00161">tracked_memory.h:161</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee">EC_NoError</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00116">tracked_memory.h:116</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_ab753a667917e4aa67a8e5ee2117083ba"><div class="ttname"><a href="tracked__memory_8c.html#ab753a667917e4aa67a8e5ee2117083ba">check_block</a></div><div class="ttdeci">enum E_MEMORY_ERROR check_block(struct memblock_header *memory_block)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00092">tracked_memory.c:92</a></div></div>
<div class="ttc" id="structmemblock__header_html_a97093dcb31daa58a36e471701b63d0d3"><div class="ttname"><a href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">memblock_header::file</a></div><div class="ttdeci">char file[MEM_MAX_FILENAME_LENGTH+1]</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00092">tracked_memory.h:92</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_ad4ec1862e1c0007f85c0d0eb6b75ff91"><div class="ttname"><a href="tracked__memory_8c.html#ad4ec1862e1c0007f85c0d0eb6b75ff91">block_offset_realmem</a></div><div class="ttdeci">#define block_offset_realmem(memblock)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00037">tracked_memory.c:37</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfabb546aef3131ea5f3da84fd374da1f45">EC_CorruptHeader</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00118">tracked_memory.h:118</a></div></div>
<div class="ttc" id="structmemblock__header_html_aa2bb67f4837cf735956c591e23e4c800"><div class="ttname"><a href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">memblock_header::line</a></div><div class="ttdeci">uint32_t line</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00098">tracked_memory.h:98</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_a4f16e38be32a4bbda23c530b11e19fb8"><div class="ttname"><a href="tracked__memory_8h.html#a4f16e38be32a4bbda23c530b11e19fb8">MEM_LEAK_LOG_NAME</a></div><div class="ttdeci">#define MEM_LEAK_LOG_NAME</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00036">tracked_memory.h:36</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_a8aa19886dfd5381ab173d9fcfec3e01d"><div class="ttname"><a href="tracked__memory_8h.html#a8aa19886dfd5381ab173d9fcfec3e01d">PRINT_POINTER</a></div><div class="ttdeci">#define PRINT_POINTER</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00050">tracked_memory.h:50</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_a23fcee323662954abeea9a2b0d3d7bdf"><div class="ttname"><a href="tracked__memory_8c.html#a23fcee323662954abeea9a2b0d3d7bdf">HEADER_FOOTER_SIZE</a></div><div class="ttdeci">#define HEADER_FOOTER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00041">tracked_memory.c:41</a></div></div>
<div class="ttc" id="queue_8h_html_aaae87ca18c28066e1a96221e762d1209"><div class="ttname"><a href="queue_8h.html#aaae87ca18c28066e1a96221e762d1209">TAILQ_REMOVE</a></div><div class="ttdeci">#define TAILQ_REMOVE(head, elm, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00659">queue.h:659</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbf"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbf">E_MEMORY_ERROR</a></div><div class="ttdeci">E_MEMORY_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00114">tracked_memory.h:114</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_aa041ffb2d12d9cd00022df58acb31c92"><div class="ttname"><a href="tracked__memory_8h.html#aa041ffb2d12d9cd00022df58acb31c92">MEM_OUTPUT_LIMIT</a></div><div class="ttdeci">#define MEM_OUTPUT_LIMIT</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00354">tracked_memory.h:354</a></div></div>
<div class="ttc" id="structmemblock__header_html_a9f32a9108b8ca49a6296605b42ee3a54"><div class="ttname"><a href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">memblock_header::requested_size</a></div><div class="ttdeci">uint32_t requested_size</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00100">tracked_memory.h:100</a></div></div>
<div class="ttc" id="structmem__context_html_a3eb8087c0f859202f13e8877f1871530"><div class="ttname"><a href="structmem__context.html#a3eb8087c0f859202f13e8877f1871530">mem_context::allocs</a></div><div class="ttdeci">uint32_t allocs</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00158">tracked_memory.h:158</a></div></div>
<div class="ttc" id="structmemblock__header_html_ab3a09c5ab1300cb51e93ff910431c40f"><div class="ttname"><a href="structmemblock__header.html#ab3a09c5ab1300cb51e93ff910431c40f">memblock_header::function</a></div><div class="ttdeci">char function[MEM_MAX_FUNCTION_LENGTH+1]</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00096">tracked_memory.h:96</a></div></div>
<div class="ttc" id="structmemblock__header_html"><div class="ttname"><a href="structmemblock__header.html">memblock_header</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00076">tracked_memory.h:76</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfaaacd8ad060ec70bc74896b8f3375bfff">EC_NoMemoryBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00117">tracked_memory.h:117</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfac73a2ab817ee9057c110c277e1580317"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfac73a2ab817ee9057c110c277e1580317">EC_CorruptFooter</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00119">tracked_memory.h:119</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a060364772083abaaf94eee077a5d3365"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* tracked_alloc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmem__context.html">mem_context</a> *const&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>num_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tracked version of malloc - use the MALLOC macro to call this, as it will setup the parameters for you, barring the num_bytes.</p>
<p>This function will dynamically alter the requested amount in order to leave space for a header and footer; the client code does not need to handle, or be aware, of this fact.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>The memory context to work with </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_bytes</td><td>The number of bytes to allocate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>The file this method was called in </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">function</td><td>The function this method was called in </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">line</td><td>The line number in the file this method was called in </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the allocated memory, or a nullptr if the allocation failed. </dd></dl>

<p>Definition at line <a class="el" href="tracked__memory_8c_source.html#l00337">337</a> of file <a class="el" href="tracked__memory_8c_source.html">tracked_memory.c</a>.</p>

<p>References <a class="el" href="tracked__memory_8h_source.html#l00158">mem_context::allocs</a>, <a class="el" href="tracked__memory_8c_source.html#l00039">block_offset_footer</a>, <a class="el" href="tracked__memory_8c_source.html#l00037">block_offset_realmem</a>, <a class="el" href="tracked__memory_8h_source.html#l00160">mem_context::current_allocated</a>, <a class="el" href="tracked__memory_8h_source.html#l00092">memblock_header::file</a>, <a class="el" href="tracked__memory_8h_source.html#l00086">memblock_header::footer</a>, <a class="el" href="tracked__memory_8h_source.html#l00096">memblock_header::function</a>, <a class="el" href="tracked__memory_8c_source.html#l00041">HEADER_FOOTER_SIZE</a>, <a class="el" href="tracked__memory_8h_source.html#l00098">memblock_header::line</a>, <a class="el" href="tracked__memory_8h_source.html#l00166">mem_context::lock</a>, <a class="el" href="tracked__memory_8h_source.html#l00066">memblock_footer::magic</a>, <a class="el" href="tracked__memory_8h_source.html#l00083">memblock_header::magic</a>, <a class="el" href="tracked__memory_8c_source.html#l00047">mem_footer_magic</a>, <a class="el" href="tracked__memory_8c_source.html#l00046">mem_header_magic</a>, <a class="el" href="tracked__memory_8c_source.html#l00031">MEM_ON_INIT</a>, <a class="el" href="tracked__memory_8c.html#a83cebbffc784c0755f531e4c19abf8d0">PATH_CHAR</a>, <a class="el" href="tracked__memory_8h_source.html#l00102">memblock_header::real_size</a>, <a class="el" href="tracked__memory_8h_source.html#l00100">memblock_header::requested_size</a>, <a class="el" href="queue_8h_source.html#l00641">TAILQ_INSERT_TAIL</a>, and <a class="el" href="tracked__memory_8h_source.html#l00161">mem_context::total_allocated</a>.</p>

<p>Referenced by <a class="el" href="tracked__memory_8c_source.html#l00466">tracked_realloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keyword">struct </span><a class="code" href="structmemblock__header.html">memblock_header</a>* mem_block = NULL;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keyword">struct </span><a class="code" href="structmemblock__footer.html">memblock_footer</a>* mem_footer = NULL;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordtype">void</span>*                   mem_return = NULL;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordtype">char</span>*                   p = NULL;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        uint32_t                patched_alloc = 0;      <span class="comment">// num_bytes + memblocks</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">// allocate the requested amount, plus the size of the header &amp; footer memblocks</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        patched_alloc = num_bytes + <a class="code" href="tracked__memory_8c.html#a23fcee323662954abeea9a2b0d3d7bdf">HEADER_FOOTER_SIZE</a>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">// the actual, real, physical allocation of memory</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        mem_block = (<span class="keyword">struct </span><a class="code" href="structmemblock__header.html">memblock_header</a>*)malloc(patched_alloc);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">if</span> ( mem_block == NULL )</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordflow">goto</span> alloc_failure;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="comment">// initialize the value for the new memory</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        memset(mem_block, <a class="code" href="tracked__memory_8c.html#ada833569779d8c8a9b8415e8112c1fad">MEM_ON_INIT</a>, patched_alloc);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#if defined(_WIN32)</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#       define PATH_CHAR        &#39;\\&#39;</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#else</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#       define PATH_CHAR        &#39;/&#39;</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor"></span>        <span class="comment">// we don&#39;t want the full path information that compilers set</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">if</span> (( p = strrchr(<a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>, <a class="code" href="tracked__memory_8c.html#a83cebbffc784c0755f531e4c19abf8d0">PATH_CHAR</a>)) != NULL )</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a> = ++p;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">// calculate the offsets of the return memory and the footer</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        mem_return = <a class="code" href="tracked__memory_8c.html#ad4ec1862e1c0007f85c0d0eb6b75ff91">block_offset_realmem</a>(mem_block);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        mem_footer = <a class="code" href="tracked__memory_8c.html#aff46be828cb143ee0ffde154ac547a46">block_offset_footer</a>(mem_block, num_bytes);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">// prepare the structure internals</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        mem_footer-&gt;<a class="code" href="structmemblock__footer.html#adbe248bf9ad8f03cdc7c202140989da9">magic</a>       = <a class="code" href="tracked__memory_8c.html#a89ab5016ef388d7a5691e4d77208cc32">mem_footer_magic</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        mem_block-&gt;<a class="code" href="structmemblock__header.html#a21ce1e9005809a1f4ac9d9fc16f0ccc6">footer</a>       = mem_footer;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        mem_block-&gt;<a class="code" href="structmemblock__header.html#a10ebc950edccb690a784aceb6362d696">magic</a>        = <a class="code" href="tracked__memory_8c.html#ac870dbfc709df78d9ee713843f55e894">mem_header_magic</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        mem_block-&gt;<a class="code" href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">line</a>         = <a class="code" href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">line</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        mem_block-&gt;<a class="code" href="structmemblock__header.html#acbea4f5572643309ac41e9493baaa7f7">real_size</a>            = patched_alloc;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        mem_block-&gt;<a class="code" href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">requested_size</a>       = num_bytes;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="comment">/* you should be using strlcpy if you&#39;re doing character buffer copying</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">         * and other functionality!! For the sake of securing your application,</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">         * please USE IT!</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">         * We provide a &#39;normal, well-known&#39; alternative for the sake of the</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">         * example using strncpy (which is in standard headers everywhere) */</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">#if defined(HAVE_STRLCPY)</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="preprocessor"></span>        strlcpy(mem_block-&gt;<a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>, <a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>, <span class="keyword">sizeof</span>(mem_block-&gt;<a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>));</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        strlcpy(mem_block-&gt;<a class="code" href="structmemblock__header.html#ab3a09c5ab1300cb51e93ff910431c40f">function</a>, <span class="keyword">function</span>, <span class="keyword">sizeof</span>(mem_block-&gt;<a class="code" href="structmemblock__header.html#ab3a09c5ab1300cb51e93ff910431c40f">function</a>));</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor"></span>        strncpy(mem_block-&gt;<a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>, <a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>, <span class="keyword">sizeof</span>(mem_block-&gt;<a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>)-1);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        strncpy(mem_block-&gt;<a class="code" href="structmemblock__header.html#ab3a09c5ab1300cb51e93ff910431c40f">function</a>, <span class="keyword">function</span>, <span class="keyword">sizeof</span>(mem_block-&gt;<a class="code" href="structmemblock__header.html#ab3a09c5ab1300cb51e93ff910431c40f">function</a>)-1);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="comment">/* lock this context, only 1 thread to update sensitive internals at a</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">         * time - lock for as little time as possible! */</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        pthread_mutex_lock(&amp;context-&gt;<a class="code" href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">lock</a>);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">// update the stats, using patched values</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        context-&gt;<a class="code" href="structmem__context.html#a3eb8087c0f859202f13e8877f1871530">allocs</a>++;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        context-&gt;<a class="code" href="structmem__context.html#a8edd1cdf2fb7f8e841eb7abacb839a18">current_allocated</a> += patched_alloc;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        context-&gt;<a class="code" href="structmem__context.html#a513b900aa111101d2491b1395912e7a1">total_allocated</a> += patched_alloc;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="comment">// append it to the list</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <a class="code" href="queue_8h.html#a512bee16b46f601078c96c776d2648c3">TAILQ_INSERT_TAIL</a>(&amp;context-&gt;memblocks, mem_block, np_blocks);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">// unlock the context, other threads can now allocate from this class</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        pthread_mutex_unlock(&amp;context-&gt;<a class="code" href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">lock</a>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">return</span> mem_return;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;alloc_failure:</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="ttc" id="structmem__context_html_a8edd1cdf2fb7f8e841eb7abacb839a18"><div class="ttname"><a href="structmem__context.html#a8edd1cdf2fb7f8e841eb7abacb839a18">mem_context::current_allocated</a></div><div class="ttdeci">uint32_t current_allocated</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00160">tracked_memory.h:160</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_a83cebbffc784c0755f531e4c19abf8d0"><div class="ttname"><a href="tracked__memory_8c.html#a83cebbffc784c0755f531e4c19abf8d0">PATH_CHAR</a></div><div class="ttdeci">#define PATH_CHAR</div></div>
<div class="ttc" id="tracked__memory_8c_html_ada833569779d8c8a9b8415e8112c1fad"><div class="ttname"><a href="tracked__memory_8c.html#ada833569779d8c8a9b8415e8112c1fad">MEM_ON_INIT</a></div><div class="ttdeci">#define MEM_ON_INIT</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00031">tracked_memory.c:31</a></div></div>
<div class="ttc" id="structmemblock__footer_html"><div class="ttname"><a href="structmemblock__footer.html">memblock_footer</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00064">tracked_memory.h:64</a></div></div>
<div class="ttc" id="structmem__context_html_a513b900aa111101d2491b1395912e7a1"><div class="ttname"><a href="structmem__context.html#a513b900aa111101d2491b1395912e7a1">mem_context::total_allocated</a></div><div class="ttdeci">uint32_t total_allocated</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00161">tracked_memory.h:161</a></div></div>
<div class="ttc" id="structmemblock__header_html_a97093dcb31daa58a36e471701b63d0d3"><div class="ttname"><a href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">memblock_header::file</a></div><div class="ttdeci">char file[MEM_MAX_FILENAME_LENGTH+1]</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00092">tracked_memory.h:92</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_ad4ec1862e1c0007f85c0d0eb6b75ff91"><div class="ttname"><a href="tracked__memory_8c.html#ad4ec1862e1c0007f85c0d0eb6b75ff91">block_offset_realmem</a></div><div class="ttdeci">#define block_offset_realmem(memblock)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00037">tracked_memory.c:37</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_a89ab5016ef388d7a5691e4d77208cc32"><div class="ttname"><a href="tracked__memory_8c.html#a89ab5016ef388d7a5691e4d77208cc32">mem_footer_magic</a></div><div class="ttdeci">const unsigned mem_footer_magic</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00047">tracked_memory.c:47</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_ac870dbfc709df78d9ee713843f55e894"><div class="ttname"><a href="tracked__memory_8c.html#ac870dbfc709df78d9ee713843f55e894">mem_header_magic</a></div><div class="ttdeci">const unsigned mem_header_magic</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00046">tracked_memory.c:46</a></div></div>
<div class="ttc" id="structmemblock__header_html_aa2bb67f4837cf735956c591e23e4c800"><div class="ttname"><a href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">memblock_header::line</a></div><div class="ttdeci">uint32_t line</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00098">tracked_memory.h:98</a></div></div>
<div class="ttc" id="structmem__context_html_a0ab6d63011eb813840718d80623e16c9"><div class="ttname"><a href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">mem_context::lock</a></div><div class="ttdeci">pthread_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00166">tracked_memory.h:166</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_a23fcee323662954abeea9a2b0d3d7bdf"><div class="ttname"><a href="tracked__memory_8c.html#a23fcee323662954abeea9a2b0d3d7bdf">HEADER_FOOTER_SIZE</a></div><div class="ttdeci">#define HEADER_FOOTER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00041">tracked_memory.c:41</a></div></div>
<div class="ttc" id="structmemblock__header_html_a9f32a9108b8ca49a6296605b42ee3a54"><div class="ttname"><a href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">memblock_header::requested_size</a></div><div class="ttdeci">uint32_t requested_size</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00100">tracked_memory.h:100</a></div></div>
<div class="ttc" id="structmem__context_html_a3eb8087c0f859202f13e8877f1871530"><div class="ttname"><a href="structmem__context.html#a3eb8087c0f859202f13e8877f1871530">mem_context::allocs</a></div><div class="ttdeci">uint32_t allocs</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00158">tracked_memory.h:158</a></div></div>
<div class="ttc" id="queue_8h_html_a512bee16b46f601078c96c776d2648c3"><div class="ttname"><a href="queue_8h.html#a512bee16b46f601078c96c776d2648c3">TAILQ_INSERT_TAIL</a></div><div class="ttdeci">#define TAILQ_INSERT_TAIL(head, elm, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00641">queue.h:641</a></div></div>
<div class="ttc" id="structmemblock__header_html_ab3a09c5ab1300cb51e93ff910431c40f"><div class="ttname"><a href="structmemblock__header.html#ab3a09c5ab1300cb51e93ff910431c40f">memblock_header::function</a></div><div class="ttdeci">char function[MEM_MAX_FUNCTION_LENGTH+1]</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00096">tracked_memory.h:96</a></div></div>
<div class="ttc" id="structmemblock__header_html_a21ce1e9005809a1f4ac9d9fc16f0ccc6"><div class="ttname"><a href="structmemblock__header.html#a21ce1e9005809a1f4ac9d9fc16f0ccc6">memblock_header::footer</a></div><div class="ttdeci">struct memblock_footer * footer</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00086">tracked_memory.h:86</a></div></div>
<div class="ttc" id="structmemblock__header_html_acbea4f5572643309ac41e9493baaa7f7"><div class="ttname"><a href="structmemblock__header.html#acbea4f5572643309ac41e9493baaa7f7">memblock_header::real_size</a></div><div class="ttdeci">uint32_t real_size</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00102">tracked_memory.h:102</a></div></div>
<div class="ttc" id="structmemblock__footer_html_adbe248bf9ad8f03cdc7c202140989da9"><div class="ttname"><a href="structmemblock__footer.html#adbe248bf9ad8f03cdc7c202140989da9">memblock_footer::magic</a></div><div class="ttdeci">unsigned magic</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00066">tracked_memory.h:66</a></div></div>
<div class="ttc" id="structmemblock__header_html"><div class="ttname"><a href="structmemblock__header.html">memblock_header</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00076">tracked_memory.h:76</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_aff46be828cb143ee0ffde154ac547a46"><div class="ttname"><a href="tracked__memory_8c.html#aff46be828cb143ee0ffde154ac547a46">block_offset_footer</a></div><div class="ttdeci">#define block_offset_footer(memblock, num_bytes)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00039">tracked_memory.c:39</a></div></div>
<div class="ttc" id="structmemblock__header_html_a10ebc950edccb690a784aceb6362d696"><div class="ttname"><a href="structmemblock__header.html#a10ebc950edccb690a784aceb6362d696">memblock_header::magic</a></div><div class="ttdeci">unsigned magic</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00083">tracked_memory.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adaadfc4aa30023606455c7f940868825"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tracked_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmem__context.html">mem_context</a> *const&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>memory</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tracked version of free - use the FREE macro to call this, for consistency and potential future changes.</p>
<p>In compliance with the C standard, if memory is a nullptr, this function performs no action. No action is also performed if a memory validation check fails (i.e. the supplied block is corrupt or otherwise invalid), as doing so could crash the application, and miss logging the information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>The memory context to work with </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">memory</td><td>A pointer to the memory previously allocated by tracked_alloc (which should be called via MALLOC) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tracked__memory_8c_source.html#l00420">420</a> of file <a class="el" href="tracked__memory_8c_source.html">tracked_memory.c</a>.</p>

<p>References <a class="el" href="tracked__memory_8c_source.html#l00035">block_offset_header</a>, <a class="el" href="tracked__memory_8h_source.html#l00160">mem_context::current_allocated</a>, <a class="el" href="tracked__memory_8h_source.html#l00092">memblock_header::file</a>, <a class="el" href="tracked__memory_8h_source.html#l00159">mem_context::frees</a>, <a class="el" href="tracked__memory_8h_source.html#l00098">memblock_header::line</a>, <a class="el" href="tracked__memory_8h_source.html#l00166">mem_context::lock</a>, <a class="el" href="tracked__memory_8c_source.html#l00032">MEM_AFTER_FREE</a>, <a class="el" href="tracked__memory_8h_source.html#l00102">memblock_header::real_size</a>, <a class="el" href="tracked__memory_8h_source.html#l00100">memblock_header::requested_size</a>, <a class="el" href="queue_8h_source.html#l00659">TAILQ_REMOVE</a>, and <a class="el" href="tracked__memory_8c_source.html#l00527">validate_memory()</a>.</p>

<p>Referenced by <a class="el" href="tracked__memory_8c_source.html#l00466">tracked_realloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;{</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keyword">struct </span><a class="code" href="structmemblock__header.html">memblock_header</a>* mem_block = NULL;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="comment">// as per the C standard, if it&#39;s a NULL, do nothing</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">if</span> ( memory == NULL )</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">if</span> ( !<a class="code" href="tracked__memory_8c.html#a1f0ff25556f5435b8c7048f58b3c80a9">validate_memory</a>(context, memory) )</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        mem_block = <a class="code" href="tracked__memory_8c.html#a4535345fe0fa840b2b74ce4eaf6dd004">block_offset_header</a>(memory);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">#if !defined(DISABLE_MEMORY_OP_TO_STDOUT)</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="preprocessor"></span>        printf( <span class="stringliteral">&quot;free [%s (%u bytes) line %u]\n&quot;</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <span class="stringliteral">&quot;\tBlock: %p | Usable Block: %p\n&quot;</span>,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                mem_block-&gt;<a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>, mem_block-&gt;<a class="code" href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">requested_size</a>, mem_block-&gt;<a class="code" href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">line</a>,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                mem_block, memory);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="comment">// stop other modifications on this memory context</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        pthread_mutex_lock(&amp;context-&gt;<a class="code" href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">lock</a>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">// update the context stats</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        context-&gt;<a class="code" href="structmem__context.html#a816e6dda100a2b8133c078194cd41f11">frees</a>++;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        context-&gt;<a class="code" href="structmem__context.html#a8edd1cdf2fb7f8e841eb7abacb839a18">current_allocated</a> -= (mem_block-&gt;<a class="code" href="structmemblock__header.html#acbea4f5572643309ac41e9493baaa7f7">real_size</a>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="comment">// remove the mem_block from the list</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <a class="code" href="queue_8h.html#aaae87ca18c28066e1a96221e762d1209">TAILQ_REMOVE</a>(&amp;context-&gt;memblocks, mem_block, np_blocks);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="comment">// we&#39;re done with the class internals, open it up again</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        pthread_mutex_unlock(&amp;context-&gt;<a class="code" href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">lock</a>);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="comment">// fill the app-allocated memory (highlights use after free)</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        memset(mem_block, <a class="code" href="tracked__memory_8c.html#ab4cd30097b76edd986e9f0db035b6279">MEM_AFTER_FREE</a>, mem_block-&gt;<a class="code" href="structmemblock__header.html#acbea4f5572643309ac41e9493baaa7f7">real_size</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">// perform the actual freeing of memory, including our header + footer</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        free(mem_block);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div>
<div class="ttc" id="structmem__context_html_a8edd1cdf2fb7f8e841eb7abacb839a18"><div class="ttname"><a href="structmem__context.html#a8edd1cdf2fb7f8e841eb7abacb839a18">mem_context::current_allocated</a></div><div class="ttdeci">uint32_t current_allocated</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00160">tracked_memory.h:160</a></div></div>
<div class="ttc" id="structmem__context_html_a816e6dda100a2b8133c078194cd41f11"><div class="ttname"><a href="structmem__context.html#a816e6dda100a2b8133c078194cd41f11">mem_context::frees</a></div><div class="ttdeci">uint32_t frees</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00159">tracked_memory.h:159</a></div></div>
<div class="ttc" id="structmemblock__header_html_a97093dcb31daa58a36e471701b63d0d3"><div class="ttname"><a href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">memblock_header::file</a></div><div class="ttdeci">char file[MEM_MAX_FILENAME_LENGTH+1]</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00092">tracked_memory.h:92</a></div></div>
<div class="ttc" id="structmemblock__header_html_aa2bb67f4837cf735956c591e23e4c800"><div class="ttname"><a href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">memblock_header::line</a></div><div class="ttdeci">uint32_t line</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00098">tracked_memory.h:98</a></div></div>
<div class="ttc" id="structmem__context_html_a0ab6d63011eb813840718d80623e16c9"><div class="ttname"><a href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">mem_context::lock</a></div><div class="ttdeci">pthread_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00166">tracked_memory.h:166</a></div></div>
<div class="ttc" id="queue_8h_html_aaae87ca18c28066e1a96221e762d1209"><div class="ttname"><a href="queue_8h.html#aaae87ca18c28066e1a96221e762d1209">TAILQ_REMOVE</a></div><div class="ttdeci">#define TAILQ_REMOVE(head, elm, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00659">queue.h:659</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_a4535345fe0fa840b2b74ce4eaf6dd004"><div class="ttname"><a href="tracked__memory_8c.html#a4535345fe0fa840b2b74ce4eaf6dd004">block_offset_header</a></div><div class="ttdeci">#define block_offset_header(real_mem)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00035">tracked_memory.c:35</a></div></div>
<div class="ttc" id="structmemblock__header_html_a9f32a9108b8ca49a6296605b42ee3a54"><div class="ttname"><a href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">memblock_header::requested_size</a></div><div class="ttdeci">uint32_t requested_size</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00100">tracked_memory.h:100</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_ab4cd30097b76edd986e9f0db035b6279"><div class="ttname"><a href="tracked__memory_8c.html#ab4cd30097b76edd986e9f0db035b6279">MEM_AFTER_FREE</a></div><div class="ttdeci">#define MEM_AFTER_FREE</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00032">tracked_memory.c:32</a></div></div>
<div class="ttc" id="structmemblock__header_html_acbea4f5572643309ac41e9493baaa7f7"><div class="ttname"><a href="structmemblock__header.html#acbea4f5572643309ac41e9493baaa7f7">memblock_header::real_size</a></div><div class="ttdeci">uint32_t real_size</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00102">tracked_memory.h:102</a></div></div>
<div class="ttc" id="structmemblock__header_html"><div class="ttname"><a href="structmemblock__header.html">memblock_header</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00076">tracked_memory.h:76</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_a1f0ff25556f5435b8c7048f58b3c80a9"><div class="ttname"><a href="tracked__memory_8c.html#a1f0ff25556f5435b8c7048f58b3c80a9">validate_memory</a></div><div class="ttdeci">bool validate_memory(struct mem_context *const context, void *memory)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00527">tracked_memory.c:527</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4e46491d14d0a28b73e4758cc2b20d3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* tracked_realloc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmem__context.html">mem_context</a> *const&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>memory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>new_num_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tracked version of realloc - use the REALLOC macro to call this.</p>
<p>In compliance with the C standard, if memory_block is a nullptr, the end result is the same as calling tracked_alloc (i.e. malloc). The same applies if new_num_bytes is 0 - tracked_free (i.e. free) will be called on the memory block.</p>
<p>No validation is performed on the original block of memory, and unlike the real realloc, we call TrackedAlloc regardless of size differences and other parameters. The previous memory is then moved into this newly allocated block, and the original freed.</p>
<p>As a result, a TrackedRealloc guarantees that the returned pointer will never be the same as the one passed in.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>The memory context to work with </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">memory</td><td>The pointer to memory returned by TrackedAlloc() </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">new_num_bytes</td><td>The new number of bytes to allocate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>The file this method was called in </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">function</td><td>The function this method was called in </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">line</td><td>The line number in the file this method was called in </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">nullptr</td><td>if the function fails due to invalid parameters, or the call to realloc fails </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the usable block of memory allocated </dd></dl>

<p>Definition at line <a class="el" href="tracked__memory_8c_source.html#l00466">466</a> of file <a class="el" href="tracked__memory_8c_source.html">tracked_memory.c</a>.</p>

<p>References <a class="el" href="tracked__memory_8c_source.html#l00035">block_offset_header</a>, <a class="el" href="tracked__memory_8h_source.html#l00166">mem_context::lock</a>, <a class="el" href="tracked__memory_8h_source.html#l00100">memblock_header::requested_size</a>, <a class="el" href="tracked__memory_8c_source.html#l00337">tracked_alloc()</a>, and <a class="el" href="tracked__memory_8c_source.html#l00420">tracked_free()</a>.</p>
<div class="fragment"><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;{</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keyword">struct </span><a class="code" href="structmemblock__header.html">memblock_header</a>* mem_block = NULL;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordtype">void</span>*                   mem_return = NULL;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordflow">if</span> ( memory == NULL )</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                <span class="comment">// if the memory is NULL, call malloc [ISO C]</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="tracked__memory_8c.html#a060364772083abaaf94eee077a5d3365">tracked_alloc</a>(context, new_num_bytes, <a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>, <span class="keyword">function</span>, <a class="code" href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">line</a>);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">if</span> ( new_num_bytes == 0 )</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                <span class="comment">/* if new_num_bytes is 0 and the memory is not null, call</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">                 * free() [ISO C] */</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                <a class="code" href="tracked__memory_8c.html#adaadfc4aa30023606455c7f940868825">tracked_free</a>(context, memory);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="comment">/* whether it works or fails, the memory is still unusable, so</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">                 * return a NULL */</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        pthread_mutex_lock(&amp;context-&gt;<a class="code" href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">lock</a>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor">#if !defined(DISABLE_MEMORY_OP_TO_STDOUT)</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="preprocessor"></span>        <span class="comment">// since we call TrackedAlloc, make the log info accurate</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        printf( <span class="stringliteral">&quot;realloc [%s (%u bytes) line %u]\n&quot;</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <span class="stringliteral">&quot;\tTo be allocated in the following malloc; using memory at: %p\n&quot;</span>,</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>, new_num_bytes, <a class="code" href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">line</a>,</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                memory);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        mem_return = (<span class="keywordtype">void</span>*)<a class="code" href="tracked__memory_8c.html#a060364772083abaaf94eee077a5d3365">tracked_alloc</a>(context, new_num_bytes, <a class="code" href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">file</a>, <span class="keyword">function</span>, <a class="code" href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">line</a>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span> ( mem_return != NULL )</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                mem_block = <a class="code" href="tracked__memory_8c.html#a4535345fe0fa840b2b74ce4eaf6dd004">block_offset_header</a>(memory);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                <span class="comment">// move the original data into the new allocation</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                mem_block-&gt;<a class="code" href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">requested_size</a> &lt; new_num_bytes ?</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                        memmove(mem_return, memory, new_num_bytes) :</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                        memmove(mem_return, memory, mem_block-&gt;<a class="code" href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">requested_size</a>);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                <span class="comment">// free the original block</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <a class="code" href="tracked__memory_8c.html#adaadfc4aa30023606455c7f940868825">tracked_free</a>(context, memory);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        pthread_mutex_unlock(&amp;context-&gt;<a class="code" href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">lock</a>);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">return</span> mem_return;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div>
<div class="ttc" id="structmemblock__header_html_a97093dcb31daa58a36e471701b63d0d3"><div class="ttname"><a href="structmemblock__header.html#a97093dcb31daa58a36e471701b63d0d3">memblock_header::file</a></div><div class="ttdeci">char file[MEM_MAX_FILENAME_LENGTH+1]</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00092">tracked_memory.h:92</a></div></div>
<div class="ttc" id="structmemblock__header_html_aa2bb67f4837cf735956c591e23e4c800"><div class="ttname"><a href="structmemblock__header.html#aa2bb67f4837cf735956c591e23e4c800">memblock_header::line</a></div><div class="ttdeci">uint32_t line</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00098">tracked_memory.h:98</a></div></div>
<div class="ttc" id="structmem__context_html_a0ab6d63011eb813840718d80623e16c9"><div class="ttname"><a href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">mem_context::lock</a></div><div class="ttdeci">pthread_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00166">tracked_memory.h:166</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_a4535345fe0fa840b2b74ce4eaf6dd004"><div class="ttname"><a href="tracked__memory_8c.html#a4535345fe0fa840b2b74ce4eaf6dd004">block_offset_header</a></div><div class="ttdeci">#define block_offset_header(real_mem)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00035">tracked_memory.c:35</a></div></div>
<div class="ttc" id="structmemblock__header_html_a9f32a9108b8ca49a6296605b42ee3a54"><div class="ttname"><a href="structmemblock__header.html#a9f32a9108b8ca49a6296605b42ee3a54">memblock_header::requested_size</a></div><div class="ttdeci">uint32_t requested_size</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00100">tracked_memory.h:100</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_adaadfc4aa30023606455c7f940868825"><div class="ttname"><a href="tracked__memory_8c.html#adaadfc4aa30023606455c7f940868825">tracked_free</a></div><div class="ttdeci">void tracked_free(struct mem_context *const context, void *memory)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00420">tracked_memory.c:420</a></div></div>
<div class="ttc" id="structmemblock__header_html"><div class="ttname"><a href="structmemblock__header.html">memblock_header</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00076">tracked_memory.h:76</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_a060364772083abaaf94eee077a5d3365"><div class="ttname"><a href="tracked__memory_8c.html#a060364772083abaaf94eee077a5d3365">tracked_alloc</a></div><div class="ttdeci">void * tracked_alloc(struct mem_context *const context, const uint32_t num_bytes, const char *file, const char *function, const uint32_t line)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00337">tracked_memory.c:337</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1f0ff25556f5435b8c7048f58b3c80a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool validate_memory </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmem__context.html">mem_context</a> *const&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>memory</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Validates a tracked bit of memory; if no pointer is supplied, so nullptr is passed in, every tracked block currently present in the class is validated.</p>
<p>If present, the memory passed in must be at the pointer to the memory returned by the tracked_alloc/tracked_realloc caller.</p>
<p>Internally calls <a class="el" href="tracked__memory_8h.html#ab753a667917e4aa67a8e5ee2117083ba">check_block()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>The <a class="el" href="structmem__context.html">mem_context</a> memory resides in </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">memory</td><td>A pointer to the memory to validate </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>if the memory is not corrupt and usable </td></tr>
    <tr><td class="paramname">false</td><td>if the memory failed one of the checks </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tracked__memory_8c_source.html#l00527">527</a> of file <a class="el" href="tracked__memory_8c_source.html">tracked_memory.c</a>.</p>

<p>References <a class="el" href="tracked__memory_8c_source.html#l00035">block_offset_header</a>, <a class="el" href="tracked__memory_8c_source.html#l00092">check_block()</a>, <a class="el" href="tracked__memory_8h_source.html#l00116">EC_NoError</a>, <a class="el" href="tracked__memory_8h_source.html#l00166">mem_context::lock</a>, and <a class="el" href="queue_8h_source.html#l00557">TAILQ_FOREACH</a>.</p>

<p>Referenced by <a class="el" href="tracked__memory_8c_source.html#l00420">tracked_free()</a>.</p>
<div class="fragment"><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;{</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordtype">bool</span>    ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keyword">struct </span><a class="code" href="structmemblock__header.html">memblock_header</a>* mem_block;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        pthread_mutex_lock(&amp;context-&gt;<a class="code" href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">lock</a>);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="comment">// if no pointer was specified, check the entire list</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">if</span> ( memory == NULL )</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                <a class="code" href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a>(mem_block, &amp;context-&gt;memblocks, np_blocks)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        <span class="comment">// bail if a block is invalid</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        <span class="keywordflow">if</span> ( <a class="code" href="tracked__memory_8c.html#ab753a667917e4aa67a8e5ee2117083ba">check_block</a>(mem_block) != <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee">EC_NoError</a> )</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                        {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                        }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                mem_block = <a class="code" href="tracked__memory_8c.html#a4535345fe0fa840b2b74ce4eaf6dd004">block_offset_header</a>(memory);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                ret = (<a class="code" href="tracked__memory_8c.html#ab753a667917e4aa67a8e5ee2117083ba">check_block</a>(mem_block) == <a class="code" href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee">EC_NoError</a>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        pthread_mutex_unlock(&amp;context-&gt;<a class="code" href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">lock</a>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;}</div>
<div class="ttc" id="queue_8h_html_a16e5fc168e7f3494d4b1df54447d871e"><div class="ttname"><a href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a></div><div class="ttdeci">#define TAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00557">queue.h:557</a></div></div>
<div class="ttc" id="tracked__memory_8h_html_adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee"><div class="ttname"><a href="tracked__memory_8h.html#adc7040deea27628dba424c534b71dbbfa0bb40faa20ee2383cd4071a19e6756ee">EC_NoError</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00116">tracked_memory.h:116</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_ab753a667917e4aa67a8e5ee2117083ba"><div class="ttname"><a href="tracked__memory_8c.html#ab753a667917e4aa67a8e5ee2117083ba">check_block</a></div><div class="ttdeci">enum E_MEMORY_ERROR check_block(struct memblock_header *memory_block)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00092">tracked_memory.c:92</a></div></div>
<div class="ttc" id="structmem__context_html_a0ab6d63011eb813840718d80623e16c9"><div class="ttname"><a href="structmem__context.html#a0ab6d63011eb813840718d80623e16c9">mem_context::lock</a></div><div class="ttdeci">pthread_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00166">tracked_memory.h:166</a></div></div>
<div class="ttc" id="tracked__memory_8c_html_a4535345fe0fa840b2b74ce4eaf6dd004"><div class="ttname"><a href="tracked__memory_8c.html#a4535345fe0fa840b2b74ce4eaf6dd004">block_offset_header</a></div><div class="ttdeci">#define block_offset_header(real_mem)</div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8c_source.html#l00035">tracked_memory.c:35</a></div></div>
<div class="ttc" id="structmemblock__header_html"><div class="ttname"><a href="structmemblock__header.html">memblock_header</a></div><div class="ttdef"><b>Definition:</b> <a href="tracked__memory_8h_source.html#l00076">tracked_memory.h:76</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a7d7857f56a1eceeb304e53870738e18f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structmem__context.html">mem_context</a> g_mem_ctx</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The default, global, memory context to use for all memory operations </p>

<p>Definition at line <a class="el" href="tracked__memory_8c_source.html#l00050">50</a> of file <a class="el" href="tracked__memory_8c_source.html">tracked_memory.c</a>.</p>

<p>Referenced by <a class="el" href="main_8c_source.html#l00012">main()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 11 2014 20:09:22 for Trezanik MemMgr (C) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
